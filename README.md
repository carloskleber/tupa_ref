# TUPÃ
Reference model for Electromagnetic Field Transient Simulations - codename TUPÃ

This solver is based in my dissertation "Modelagem de Linhas de Transmissão para Análise de Comportamento Quanto a Descargas Atmosféricas" (Modelling of Transmission Lines in Analysis of Lightning Performance), UFRJ, 2003, DOI:10.13140/RG.2.2.19894.56644 ; following my advisor´s original work:

* Portela, C. “Frequency and Transient Behavior of Grounding Systems, Part I - Physical and Methodological Aspects; Part II - Practical Application Examples”, Proceedings IEEE International Symposium on Electromagnetic Compatibility, pp. 379–390, Austin, USA, August 1997.

Also I like to acknowledge my colleagues` work in the field:

* Salari, J. C., Azevedo, R. M. and Portela, C. "An efficient modeling of transmission lines towers and grounding systems for lightning propagation studies," IX SIPDA, Foz do Iguaçu, Brazil, Nov. 2007.
*  S. Visacro and A. Soares, Jr., “HEM: A model for simulation of lightning related engineering problems,” IEEE Trans. Power Del., vol. 20, no. 2, pp. 1206–1208, Apr. 2005.

## Purpose

The model is an application of the Method of Moments (MoM), also called in the power system community as Hybrid Electromagnetic Model (HEM).

The first implementations is in Fortran, because why not? Well, part of the previous code are alreadly in Fortran, I just cleaned up and updated to modern standards. Other possible implementations are Rust, Python etc, which can coexist in this repository, and ocasianally sharing a common folder with test cases and results.

Independently from the language, what is expected:
* A Study object concentrating all data and dealing with I/O (loading, saving, displaying, error handling);
* An Element base object, which derived type are Line, Catenary, Circunference etc, representing geometric forms or even real objects like Tower, Pole;
* Two type of objects, generated by each Element:
    * Node - 3D points with voltage;
    * Electrode - line segments, connecting two Nodes, with voltage, longitudinal current and transversal current quantities;
* A number of Material objects, assigned to each Electrode, and also for the ground and air, with parameters like conductivity, permittivity and permeability;
* One Mesh object which with an array of Nodes and Electrodes constitues a interconneced mesh, which implements one specific MoM implementation, solving a system of voltages and currents in frequency domain;
* One Collector object, containing an array of Outputs, defined beforehand, to extrack and postprocess data from the Mesh solution.

## How to

The project can be applied standalone using the existing projects, or adapted as a library, connecting with frontends.

It is expected to have a JSON parser in each implementation, and reference cases in a `common` folder.

## Regarding the name

According to Wikipedia, _Tupã_ (or _Tupan_, _Tupave_ or _Tenondete_) is the word for God in the Tupi and Guarani languages, being one of your manifestations in the form of thunder, probably the name itself literally "the sound of thunder". As the model related to lightning phenomena and conceived in Brazil the name TUPÃ was used in the original Matlab routine, whcih to avoid encoding problems can be used as "TUPA".

![An idea of logo made by AI, something like an indian god with fire hair and a small lightning below](tupa.jpg "An idea of logo made by AI...")